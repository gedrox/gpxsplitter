// Generated by CoffeeScript 1.7.1
var MapBox;

MapBox = React.createClass({
  displayName: 'MapBox',
  propTypes: {
    apiToken: React.PropTypes.string.isRequired,
    id: React.PropTypes.string.isRequired,
    lines: React.PropTypes.arrayOf(React.PropTypes.shape({
      id: React.PropTypes.string.isRequired,
      points: React.PropTypes.array.isRequired,
      strokeColor: React.PropTypes.string.isRequired,
      strokeWidth: React.PropTypes.number
    }))
  },
  defaultState: {
    geoJSONSources: []
  },
  defaultProps: {
    styleUrl: 'https://www.mapbox.com/mapbox-gl-styles/styles/outdoors-v4.json'
  },
  addGeoJSONSource: function(line) {
    var geoJSONSource;
    geoJSONSource = new mapboxgl.GeoJSONSource({
      data: {
        type: 'Feature',
        geometry: {
          type: 'LineString',
          coordinates: line.points.map(function(point) {
            return [point.longitude, point.latitude];
          })
        }
      }
    });
    this.map.addSource('route', geoJSONSource);
    return geoJSONSource;
  },
  componentDidMount: function() {
    var geoJSONSource;
    mapboxgl.accessToken = this.props.apiToken;
    console.log('componentDidMount');
    mapboxStyle.layers.push({
      "id": "route",
      "source": "route",
      "render": {
        "$type": "LineString",
        "line-join": "round",
        "line-cap": "round"
      },
      "style": {
        "line-color": "#FF4136",
        "line-width": 3
      },
      "type": "line"
    });
    this.map = new mapboxgl.Map({
      container: this.props.id,
      style: mapboxStyle,
      center: [38.3911370, -122.4399970],
      zoom: 15
    });
    return geoJSONSource = this.addGeoJSONSource(this.props.lines[0]);
  },
  render: function() {
    return React.DOM.div({
      "style": {
        height: this.props.height,
        width: this.props.width,
        position: 'relative'
      },
      "id": this.props.id
    });
  }
});
